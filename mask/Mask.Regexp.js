Meio.Mask.Regexp=new Class({Extends:Meio.Mask,options:{regex:null,regexOptions:"i"},initialize:function(a,b){this.parent(a,b);this.regex="function"==typeof XRegExp?"string"===typeof this.options.regex?XRegExp(this.options.regex,this.options.regexOptions):XRegExp(this.options.regex):new RegExp(this.options.regex,this.options.regexOptions)},keypress:function(a,b){if(this.ignore)return!0;a.preventDefault();var c=this.getCurrentState(a,b);a=[this.element,c._char,a.code];this.regex.test(c.value)?(this.element.set("value",
c.value).setCaretPosition(c.start+(b.isRemoveKey?0:1)),this.fireEvent("valid",a)):this.fireEvent("invalid",a);return!0},paste:function(a,b){a=this.applyMask(this.element.get("value"),!0);this.element.set("value",a.value).setCaretPosition(a.index)},applyMask:function(a,b){for(var c="",e,d=1;d<=a.length;d++){e=a.substring(0,d);if(!this.regex.test(e)){b&&this.fireEvent("invalid",[this.element,a.charAt(d),a.charCodeAt(d)]);break}c=e}return{value:c,index:d}},mask:function(a){return this.applyMask(a).value}});
Meio.Mask.createMasks("Regexp",{Ip:{regex:/^(\d{0,3}\.){0,3}(\d{0,3})?$/},Email:{regex:/^[\w.!#$%&'*+=?~^_`{|}\/-]*@?[.\w-]*$/},Number:{regex:/^\d{0,4}(\.\d{0,2})?$/}});
