addEvents({load:function(){var notes=JSON.decode(localStorage["notes"]);$$("[type=editable]").each(function(ele){var current=ele.get("html");if(!current)ele.set("html",notes)});$$(".draggable").each(function(item){item.setStyle("visibility","hidden");item.makeDraggable({handle:item.getElement(".draggable_handle"),container:document.body,includeMargins:true})});$$(".resizable").each(function(item){item.makeResizable({handle:item.getElement(".resizable_handle"),limit:{x:[200,800],y:[100,600]}})});var positions=JSON.decode(localStorage["draggable_positions"]);if(positions){$$(".draggable").each(function(item,i){var pos=positions[i];if(pos.x>0&&pos.y>0)item.setPosition(positions[i]);item.setStyle("visibility","visible")})}var sizes=JSON.decode(localStorage["resizable_sizes"]);if(sizes){$$(".resizable").each(function(item,i){var sz=sizes[i];item.setStyle("width",sz.x);item.setStyle("height",sz.y);item.setStyle("visibility","visible")})}ToggleNotes(localStorage["notes_display"]=="block")},unload:function(){var positions=[];$$(".draggable").each(function(item){positions.push(item.getPosition())});localStorage["draggable_positions"]=JSON.encode(positions);var sizes=[];$$(".resizable").each(function(item){sizes.push(item.getSize())});localStorage["resizable_sizes"]=JSON.encode(sizes);var notes=$("notes").get("html");localStorage["notes"]=JSON.encode(notes);localStorage["notes_display"]=$$(".fixed_pane")[0].getStyle("display")}});function SwitchMode(button){if(button.get("text")=="Edit"){jQuery($("notes")).aloha();button.set("text","Save")}else{jQuery($("notes")).mahalo();button.set("text","Edit")}}function ToggleNotes(show){$$(".fixed_pane").each(function(item){var display=typeof show==="undefined"?item.getStyle("display")=="none"?"block":"none":show?"block":"none";item.setStyle("display",display);if(item.getWidth()<10)item.setStyle("width",200);if(item.getHeight()<10)item.setStyle("height",160)})}